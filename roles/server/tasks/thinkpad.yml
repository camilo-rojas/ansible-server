---
# Disable close lid actions to ignore

- name: thinkpad | remove lid from logind.conf HandleLid
  replace:
    path: /etc/systemd/logind.conf
    regexp: "#HandleLidSwitch=suspend"
    replace: "HandleLidSwitch=ignore"
    backup: yes
  become: yes

- name: thinkpad | remove lid from logind.conf HandleLidExternal
  replace:
    path: /etc/systemd/logind.conf
    regexp: "#HandleLidSwitchExternalPower=suspend"
    replace: "HandleLidSwitchExternalPower=ignore"
    backup: yes
  become: yes

- name: thinkpad | remove lid from UPower.conf
  replace:
    path: /etc/UPower/UPower.conf
    regexp: "IgnoreLid=false"
    replace: "IgnoreLid=true"
    backup: yes
  become: yes

- name: thinkpad | copy network file - set ip fixed address
  ansible.builtin.command: ip address add 192.168.0.19/24 broadcast + dev enp0s25 | true
  register: ipaddout
  become: true
  changed_when: "'File exists' not in ipaddout.stdout"

- debug:
    msg: "{{ipaddout.stdout}}"
#  tags: ipconfig
#  copy:
#    src: ipconfig/20-wired.network
#    dest: /etc/systemd/network/20-wired.network
#    owner: root
#    group: root
#    mode: 0660
#  become: yes
#  become_user: root
#
#- name: thinkpad | enable networking services systemd-networkd
#  systemd:
#    name: systemd-networkd.service
#    enabled: yes
#    masked: no
#
#- name: thinkpad | start networking services systemd-networkd
#  systemd:
#    name: systemd-networkd.service
#    state: started
#
#- name: thinkpad | enable networking services systemd-resolved
#  systemd:
#    name: systemd-networkd.service
#    enabled: yes
#    masked: no
#
#- name: thinkpad | start networking services systemd-resovled
#  systemd:
#    name: systemd-networkd.service
#    state: started
