# Ansible setup
- name: ansible setup | ensure ansible is the latest version
  tags: ansible,ansible-setup
  package:
    name: ansible
    state: latest

- name: ansible setup | install required packages
  tags: ansible,ansible-setup,packages
  package:
    name:
      - "{{ dconf_package }}"
      - "{{ python_psutil_package }}"
    state: latest

- name: ansible setup | install essential packages
  tags: ansible,ansible-setup,packages
  package:
    name: '{{ essential_packages }}'
    state: latest

- name: ansible setup | ansible-aur setup
  git:
    repo: https://github.com/kewlfft/ansible-aur.git
    dest: ~/.ansible/plugins/modules/aur
    version: master
    accept_hostkey: yes
  become: yes
  become_user: "{{ user.name }}"
  tags: ansible,ansible-setup,aur,ansible-aur

- name: ansible setup | install yay
  become: yes
  become_user: {{ user.name }}
  kewlfft.aur.aur:
    name: yay
    use: makepkg
    state: latest

- name: system setup | alacritty font | change font size alacritty
  replace:
    path: "/home/{{ user.name }}/.config/alacritty/alacritty.yml"
    regexp: "  size: 12"
    replace: "  size: {{ alacritty_font_size }}"
    backup: yes

- name: system setup | enable openssh daemon
  ansible.builtin.systemd:
      name: sshd
      enabled: yes
      masked: no

- name: system setup | start openssh daemon
  ansible.builtin.systemd:
      state: started
      name: sshd
